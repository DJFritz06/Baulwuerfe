<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Baulwürfe</title>
    <link href="karte0.txt" id="karte0" type="file">
</head>

<body style="background-color: rgb(170, 102, 0); text-align: center;">
    <p1 style="font-size: 60px;">Baulwürfe</p1>
    <div id="container"></div>
    <div id="button" onclick="sortieren()">Sortieren & Auszählen</div>
    <script>
        var input = document.createElement('input');
                    input.type = 'file';
        var inhalt = "";
        var karte = [];

        input.onchange = e => {

            // getting a hold of the file reference
            var file = e.target.files[0];

            // setting up the reader
            var reader = new FileReader();
            reader.readAsText(file, 'UTF-8');

            // here we tell the reader what to do when it's done reading...
            reader.onload = readerEvent => {
                inhalt = readerEvent.target.result; // this is the content!
                console.log(inhalt);
                karte = [];
                sortieren();
                return inhalt;
            }
        }
        document.getElementById('container').appendChild(input);

        function sortieren() {
            var zeilen = inhalt.split("\n");
            var angabe = zeilen.splice(0, 2);
            zeilen.splice(6, 1);
            for (var i = 0; i < zeilen.length;  i++) {
                var x = i;
                var stellen = zeilen[x].split("");
                if (i == 0 ) { karte.splice(0, 0, []); }
                karte.splice(-1, 0, stellen);
                if (i == zeilen.length - 1) { karte.splice(zeilen.length, 1) }
            }
            console.log(zeilen, karte);
            auszaehlen();
            return karte;
        }

        function auszaehlen() {
            var baulwurfCount = 0;
            for (var i = 0; i < karte.length; i++) {
                let g = i;  
                for (var e = 0; e < karte[g].length; e++) {
                    let x = "x",
                        o = "o",
                        h = e;
                    if (karte[g][h] == x) {
                        var nextH = h + 1,
                            nextH2 = h + 2,
                            nextG = g + 1,
                            nextG2 = g + 2,
                            nextG3 = g + 3,
                            x1 = karte[g][h],
                            x2 = karte[g][nextH],
                            x3 = karte[g][nextH2],
                            x4 = karte[nextG][h],
                            x5 = karte[nextG][nextH2],
                            x6 = karte[nextG2][h],
                            x7 = karte[nextG2][nextH2],
                            x8 = karte[nextG3][h],
                            x9 = karte[nextG3][nextH],
                            x10 = karte[nextG3][nextH2];
                        if (x1 == x || x2 == x && x3 == x && x4 == x && x5 == x && x6 == x && x7 == x && x8 == x && x9 == x && x10 == x) {
                            baulwurfCount++;
                            console.log(baulwurfCount, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, karte[4][2]);
                        } else {
                            karte[0].splice(0, 1, "o");
                            baulwurfCount = 50;
                            console.log(baulwurfCount);
                        }
                    }
                }
            }
        }

    </script>
</body>

</html>